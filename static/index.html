<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Google Sign-In with Firebase</title>
  <script src="https://www.gstatic.com/firebasejs/10.5.2/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.5.2/firebase-auth.js"></script>
</head>
<body>
  <h1>Google Login</h1>
  <button id="login">Sign in with Google</button>

  <p id="output"></p>
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.9.1/firebase-app.js";
  import { getAuth, signInWithPopup, GoogleAuthProvider } from "https://www.gstatic.com/firebasejs/11.9.1/firebase-auth.js";

  const firebaseConfig = {
      apiKey: "AIzaSyAhkwpAm5m9dMDGzMlA-DkOxvUY_a60Zts",
      authDomain: "bookrental-t.firebaseapp.com",
      projectId: "bookrental-t",
      storageBucket: "bookrental-t.firebasestorage.app",
      messagingSenderId: "13147389735",
      appId: "1:13147389735:web:8be287896188e7a9c77302",
      measurementId: "G-ZTC5KYVMP0"
    };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const provider = new GoogleAuthProvider();

  // Optional: restrict to a specific org domain
  provider.setCustomParameters({
    prompt: "select_account" });//, hd: "vitstudent.ac.in"
  

  document.getElementById("login").onclick = () => {
    signInWithPopup(auth, provider)
      .then(result => result.user.getIdToken())
      .then(token => {
        console.log("ID Token:", token);
        return fetch("http://localhost:8080/api/hello", {
          method: "GET",
          headers: {
            Authorization: `Bearer ${token}`
          }
        });
      })
      .then(res => res.text())
      .then(msg => {
        document.getElementById("output").innerText = msg;
      })
      .catch(error => {
        console.error("Error:", error);
        document.getElementById("output").innerText = "Login failed.";
      });
  };

</script>


</body>
</html>
